<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Appointments - Yanet Dental Clinic</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 flex flex-col min-h-screen">

<!-- HEADER -->
<header class="bg-[#E6F7F9] shadow-sm border-b border-gray-200 fixed top-0 left-0 w-full z-50 backdrop-blur-sm">
  <div class="container mx-auto flex items-center justify-between px-4 py-2 sm:py-3">
    <div class="flex items-center space-x-2">
      <img src="images/teeth_logo_circle.png" alt="Tooth Logo" class="w-10 h-10 rounded-full object-cover">
    </div>
    <div class="flex flex-col items-center leading-tight flex-grow text-center">
      <h1 class="font-extrabold text-lg sm:text-xl tracking-wide text-[#2563EB]">YANET SPECIALITY</h1>
      <h2 class="font-extrabold text-base sm:text-lg tracking-wide text-[#2563EB]">DENTAL CLINIC</h2>
    </div>
    <div class="flex items-center space-x-2">
      <a href="tel:0116662828" class="flex items-center space-x-1 bg-[#2563EB] text-white text-xs sm:text-sm font-semibold px-2.5 py-1 rounded-md hover:bg-blue-700 transition">
        📞 <span>Call Us</span>
      </a>
    </div>
  </div>
</header>

<main class="flex-1 px-4 pt-28 pb-36"> <!-- increased pb to ensure sticky footer visible -->

  <!-- General Info Section -->
  <section class="max-w-md mx-auto bg-white p-6 rounded-xl shadow-md mb-6">
    <h2 class="text-xl font-bold text-center text-blue-600">Patient Information</h2>
    <div class="mt-4 space-y-3">
      <input id="g_name" type="text" placeholder="Full Name" class="w-full border rounded-lg px-3 py-2" required>
      <input id="g_email" type="email" placeholder="Email" class="w-full border rounded-lg px-3 py-2" required>
      <input id="g_phone" type="tel" placeholder="Phone Number" class="w-full border rounded-lg px-3 py-2" required>
      <select id="g_service" class="w-full border rounded-lg px-3 py-2" required>
        <option value="">-- Choose a Service --</option>
        <option value="Cleaning">Dental Cleaning</option>
        <option value="Tooth Extraction">Tooth Extraction</option>
        <option value="Root Canal">Root Canal</option>
        <option value="Filling">Tooth Filling</option>
        <option value="Braces Consultation">Braces Consultation</option>
        <option value="Whitening">Teeth Whitening</option>
      </select>
      <input id="g_date" type="date" class="w-full border rounded-lg px-3 py-2" required>
    </div>
  </section>

  <!-- Tabs -->
  <div class="border-b border-gray-200 mb-6">
    <nav class="flex justify-around">
      <button class="tab-button py-3 px-2 text-sm font-medium text-gray-600 hover:text-blue-600 border-b-2 border-transparent" data-tab="book">Book Appointment</button>
      <button class="tab-button py-3 px-2 text-sm font-medium text-gray-600 hover:text-blue-600 border-b-2 border-transparent" data-tab="reschedule">Reschedule</button>
      <button class="tab-button py-3 px-2 text-sm font-medium text-gray-600 hover:text-blue-600 border-b-2 border-transparent" data-tab="before">Before Treatment</button>
    </nav>
  </div>

  <!-- Book Appointment -->
  <div id="book" class="tab-content">
    <form id="bookForm" class="mt-6 space-y-4 max-w-md mx-auto bg-white p-6 rounded-xl shadow-md">
      <div>
        <label class="block font-medium">Additional Notes</label>
        <textarea id="book_notes" class="w-full border rounded-lg px-3 py-2 mt-1" rows="3"></textarea>
      </div>
      <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded-lg font-semibold">Book Now</button>
      <p id="bookMsg" class="text-center mt-2"></p>
    </form>
  </div>

  <!-- Reschedule -->
  <div id="reschedule" class="tab-content hidden">
    <form id="rescheduleForm" class="mt-6 space-y-4 max-w-md mx-auto bg-white p-6 rounded-xl shadow-md">
      <div>
        <label class="block font-medium">Old Appointment Date</label>
        <input id="r_oldDate" type="date" class="w-full border rounded-lg px-3 py-2 mt-1" required>
      </div>
      <div>
        <label class="block font-medium">Reason for Reschedule</label>
        <textarea id="r_reason" class="w-full border rounded-lg px-3 py-2 mt-1" rows="3"></textarea>
      </div>
      <button type="submit" class="w-full bg-yellow-600 text-white py-2 rounded-lg font-semibold">Reschedule</button>
      <p id="rescheduleMsg" class="text-center mt-2"></p>
    </form>
  </div>

  <!-- Before Treatment -->
  <div id="before" class="tab-content hidden">
    <form id="beforeForm" class="mt-6 space-y-4 max-w-md mx-auto bg-white p-6 rounded-xl shadow-md">
      <div>
        <label class="block font-medium">Planned Treatment</label>
        <input id="b_treatment" type="text" class="w-full border rounded-lg px-3 py-2 mt-1" required>
      </div>
      <div>
        <label class="block font-medium">Medical Notes</label>
        <textarea id="b_notes" class="w-full border rounded-lg px-3 py-2 mt-1" rows="3"></textarea>
      </div>
      <button type="submit" class="w-full bg-purple-600 text-white py-2 rounded-lg font-semibold">Submit Info</button>
      <p id="beforeMsg" class="text-center mt-2"></p>
    </form>
  </div>

</main>

<!-- Sticky Bottom Navigation -->
<nav class="fixed bottom-0 left-0 w-full bg-[#E6F7F9] border-t border-gray-200 shadow-sm flex justify-around py-2 z-50 backdrop-blur-sm">
  <a href="index.html" class="flex flex-col items-center text-gray-700 hover:text-[#2563EB] transition"><span>🏠</span><span class="text-xs">Home</span></a>
  <a href="blogs.html" class="flex flex-col items-center text-gray-700 hover:text-[#2563EB] transition"><span>📝</span><span class="text-xs">Blogs</span></a>
  <a href="giveaway.html" class="flex flex-col items-center text-gray-700 hover:text-[#2563EB] transition"><span>🎁</span><span class="text-xs">Giveaway</span></a>
  <a href="appointments.html" class="flex flex-col items-center text-gray-700 hover:text-[#2563EB] transition"><span>🗓️</span><span class="text-xs">Appointments</span></a>
  <a href="chat.html" class="flex flex-col items-center text-gray-700 hover:text-[#2563EB] transition"><span>💬</span><span class="text-xs">Let’s Talk</span></a>
</nav>

<!-- Supabase & Tab Scripts -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const SUPABASE_URL = "YOUR_SUPABASE_URL";
const SUPABASE_ANON_KEY = "YOUR_SUPABASE_ANON_KEY";
const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

function getGeneralInfo(){
  return {
    name: document.getElementById("g_name").value,
    email: document.getElementById("g_email").value,
    phone: document.getElementById("g_phone").value,
    service: document.getElementById("g_service").value,
    date: document.getElementById("g_date").value
  };
}

function showMessage(elementId, message, isError=false){
  const el = document.getElementById(elementId);
  el.innerText = message;
  el.classList.remove("text-green-600","text-red-600");
  el.classList.add(isError ? "text-red-600" : "text-green-600");
  setTimeout(() => { el.innerText = ""; }, 3000);
}

// Book
document.getElementById("bookForm").addEventListener("submit", async (e)=>{
  e.preventDefault();
  const info = getGeneralInfo();
  const notes = document.getElementById("book_notes").value;
  const { error } = await supabase.from("appointments").insert([{...info, notes}]);
  showMessage("bookMsg", error ? "❌ "+error.message : "✅ Appointment saved!", !!error);
  if(!error) e.target.reset();
});

// Reschedule
document.getElementById("rescheduleForm").addEventListener("submit", async (e)=>{
  e.preventDefault();
  const info = getGeneralInfo();
  const oldDate = document.getElementById("r_oldDate").value;
  const reason = document.getElementById("r_reason").value;
  const { data, error: fetchError } = await supabase.from("appointments")
    .select("*").match({ name: info.name, phone: info.phone, date: oldDate }).limit(1);
  if(fetchError){ showMessage("rescheduleMsg", "Error: "+fetchError.message,true); return; }
  if(!data || data.length===0){ showMessage("rescheduleMsg","❌ No appointment found",true); return; }
  const { error } = await supabase.from("appointments")
    .update({ date: info.date, reason }).match({ name: info.name, phone: info.phone, date: oldDate });
  showMessage("rescheduleMsg", error ? "❌ "+error.message : "✅ Reschedule saved!", !!error);
  if(!error) e.target.reset();
});

// Before Treatment
document.getElementById("beforeForm").addEventListener("submit", async (e)=>{
  e.preventDefault();
  const info = getGeneralInfo();
  const treatment = document.getElementById("b_treatment").value;
  const notes = document.getElementById("b_notes").value;
  const { data, error: fetchError } = await supabase.from("appointments")
    .select("*").match({ name: info.name, phone: info.phone, date: info.date }).limit(1);
  if(fetchError){ showMessage("beforeMsg","Error: "+fetchError.message,true); return; }
  if(!data || data.length===0){ showMessage("beforeMsg","❌ No appointment found",true); return; }
  const { error } = await supabase.from("appointments")
    .update({ planned_treatment: treatment, medical_notes: notes }).match({ name: info.name, phone: info.phone, date: info.date });
  showMessage("beforeMsg", error ? "❌ "+error.message : "✅ Info saved!", !!error);
  if(!error) e.target.reset();
});

// Tabs switching
document.addEventListener("DOMContentLoaded", ()=>{
  const buttons = document.querySelectorAll(".tab-button");
  const contents = document.querySelectorAll(".tab-content");
  buttons.forEach(btn=>btn.addEventListener("click",()=>{
    buttons.forEach(b=>b.classList.remove("border-blue-600","text-blue-600"));
    contents.forEach(c=>c.classList.add("hidden"));
    btn.classList.add("border-blue-600","text-blue-600");
    document.getElementById(btn.dataset.tab).classList.remove("hidden");
  }));
  buttons[0].classList.add("border-blue-600","text-blue-600");
});
</script>

</body>
</html>
